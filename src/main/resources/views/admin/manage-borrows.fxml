<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>

<VBox spacing="0" 
      styleClass="root" 
      stylesheets="@/css/style.css" 
      xmlns="http://javafx.com/javafx/21" 
      xmlns:fx="http://javafx.com/fxml/1"
      fx:controller="com.intellilib.controllers.admin.ManageBorrowController">
    
    <!-- Header -->
    <HBox styleClass="site-header" alignment="CENTER_LEFT">
        <VBox spacing="4">
            <Label styleClass="page-title" text="Borrow Management"/>
            <Label styleClass="page-subtitle" text="Manage book borrows, returns, and fines"/>
        </VBox>
        <Region HBox.hgrow="ALWAYS"/>
        <HBox spacing="10">
            <Button fx:id="cancelButton" text="Close" styleClass="header-button" onAction="#handleCancel" />
        </HBox>
    </HBox>
    
    <!-- Content Area -->
    <ScrollPane styleClass="content-scroll" fitToWidth="true" VBox.vgrow="ALWAYS">
        <VBox styleClass="content-container" spacing="24">
            
            <!-- Form Section -->
            <VBox styleClass="table-section" spacing="16">
                <Label styleClass="section-title" text="New Borrow"/>
                <GridPane hgap="16" vgap="12" style="-fx-padding: 20;">
                    <Label text="Book *" styleClass="form-label" GridPane.rowIndex="0" GridPane.columnIndex="0" />
                    <ComboBox fx:id="bookCombo" styleClass="form-field" GridPane.rowIndex="0" GridPane.columnIndex="1" 
                              prefWidth="400" />
                    
                    <Label text="Member *" styleClass="form-label" GridPane.rowIndex="1" GridPane.columnIndex="0" />
                    <ComboBox fx:id="memberCombo" styleClass="form-field" GridPane.rowIndex="1" GridPane.columnIndex="1" 
                              prefWidth="400" />
                    
                    <Label text="Due Date *" styleClass="form-label" GridPane.rowIndex="2" GridPane.columnIndex="0" />
                    <DatePicker fx:id="dueDatePicker" styleClass="form-field" GridPane.rowIndex="2" GridPane.columnIndex="1" 
                                prefWidth="400" />
                    
                    <HBox spacing="10" GridPane.rowIndex="3" GridPane.columnIndex="1">
                        <Button fx:id="saveButton" text="Save Borrow" 
                                styleClass="form-button-primary" onAction="#handleSave" />
                    </HBox>
                </GridPane>
            </VBox>
            
            <!-- Fine Management Section -->
            <VBox styleClass="table-section" spacing="16">
                <Label styleClass="section-title" text="Fine Management"/>
                <HBox spacing="10" style="-fx-padding: 0 0 0 20;">
                    <Button fx:id="returnButton" text="Return Book" 
                            styleClass="form-button-secondary" onAction="#handleReturn" />
                    <Button fx:id="viewFineButton" text="View Fine Details" 
                            styleClass="form-button-secondary" onAction="#handleViewFine" />
                    <Button fx:id="payFineButton" text="Pay Fine" 
                            styleClass="form-button-secondary" onAction="#handlePayFine" />
                    <Button text="Calculate Fines" 
                            styleClass="form-button-secondary" onAction="#handleCalculateFines" />
                </HBox>
            </VBox>
            
            <!-- Table Section -->
            <VBox styleClass="table-section" spacing="16">
                <HBox spacing="10" alignment="CENTER_LEFT">
                    <Label styleClass="section-title" text="Current Borrows"/>
                    <Region HBox.hgrow="ALWAYS"/>
                    <Button text="Delete Selected" styleClass="header-button" onAction="#handleDelete" />
                </HBox>
                <TableView fx:id="borrowTable" styleClass="data-table" VBox.vgrow="ALWAYS">
                    <columns>
                        <TableColumn fx:id="idColumn" text="ID" styleClass="table-column" minWidth="60"/>
                        <TableColumn fx:id="bookTitleColumn" text="Book" styleClass="table-column" minWidth="200"/>
                        <TableColumn fx:id="memberNameColumn" text="Member" styleClass="table-column" minWidth="150"/>
                        <TableColumn fx:id="borrowDateColumn" text="Borrow Date" styleClass="table-column" minWidth="100"/>
                        <TableColumn fx:id="dueDateColumn" text="Due Date" styleClass="table-column" minWidth="100"/>
                        <TableColumn fx:id="returnDateColumn" text="Return Date" styleClass="table-column" minWidth="100"/>
                        <TableColumn fx:id="returnedColumn" text="Status" styleClass="table-column" minWidth="80"/>
                        
                        <!-- Fine columns -->
                        <TableColumn fx:id="daysOverdueColumn" text="Days Overdue" styleClass="table-column" minWidth="100"/>
                        <TableColumn fx:id="fineAmountColumn" text="Fine Amount" styleClass="table-column" minWidth="100"/>
                        <TableColumn fx:id="fineStatusColumn" text="Fine Status" styleClass="table-column" minWidth="100"/>
                    </columns>
                    <columnResizePolicy>
                        <TableView fx:constant="CONSTRAINED_RESIZE_POLICY" />
                    </columnResizePolicy>
                </TableView>
            </VBox>
            
        </VBox>
    </ScrollPane>
</VBox>