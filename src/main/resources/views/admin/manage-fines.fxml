<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.Font?>
<?import javafx.scene.control.cell.PropertyValueFactory?>
<?import javafx.scene.control.TableColumn?>

<VBox spacing="0" 
      styleClass="root" 
      stylesheets="@/css/style.css" 
      xmlns:fx="http://javafx.com/fxml" 
      fx:controller="com.intellilib.controllers.admin.ManageFinesController">
    
    <!-- Header -->
    <HBox styleClass="site-header" alignment="CENTER_LEFT">
        <VBox spacing="4">
            <Label styleClass="page-title" text="Fine Management"/>
            <Label styleClass="page-subtitle" text="Track and manage library fines and penalties"/>
        </VBox>
    </HBox>
    
    <!-- Content Area -->
    <ScrollPane styleClass="content-scroll" fitToWidth="true" VBox.vgrow="ALWAYS">
        <VBox styleClass="content-container" spacing="24">
            
            <!-- Summary Cards -->
            <HBox spacing="16">
                <VBox styleClass="stat-card" spacing="4" HBox.hgrow="ALWAYS">
                    <Label styleClass="stat-label" text="Pending Fines"/>
                    <Label fx:id="totalPendingLabel"/>
                </VBox>
                
                <VBox styleClass="stat-card" spacing="4" HBox.hgrow="ALWAYS">
                    <Label styleClass="stat-label" text="Collected"/>
                    <Label fx:id="totalCollectedLabel"/>
                </VBox>
                
                <VBox styleClass="stat-card" spacing="4" HBox.hgrow="ALWAYS">
                    <Label styleClass="stat-label" text="Waived"/>
                    <Label fx:id="totalWaivedLabel"/>
                </VBox>
                
                <VBox styleClass="stat-card" spacing="4" HBox.hgrow="ALWAYS">
                    <Label styleClass="stat-label" text="Overdue Members"/>
                    <Label fx:id="overdueMembersLabel"/>
                </VBox>
                
                <VBox styleClass="stat-card" spacing="4" HBox.hgrow="ALWAYS">
                    <Label styleClass="stat-label" text="Banned Members"/>
                    <Label fx:id="bannedMembersLabel"/>
                </VBox>
            </HBox>
            
            <!-- Search and Filters -->
            <VBox styleClass="chart-section" spacing="16">
                <Label styleClass="section-title" text="Filters"/>
                <HBox spacing="16" alignment="CENTER_LEFT">
                    <TextField fx:id="searchField" promptText="Search by member or book..." 
                               HBox.hgrow="ALWAYS"
                               style="-fx-background-color: #111111; -fx-text-fill: #ffffff; -fx-prompt-text-fill: #6b7280; -fx-border-color: #1f1f1f; -fx-border-radius: 6; -fx-background-radius: 6; -fx-padding: 10 16; -fx-font-size: 14px;"/>
                    
                    <ComboBox fx:id="statusFilter" promptText="All Status" 
                              style="-fx-background-color: #0a0a0a; -fx-text-fill: #ffffff; -fx-prompt-text-fill: #6b7280; -fx-border-color: #1f1f1f; -fx-border-radius: 6; -fx-background-radius: 6; -fx-padding: 10 12; -fx-font-size: 13px;"
                              prefWidth="140"/>
                    
                    <Label text="From:" styleClass="stat-label"/>
                    <DatePicker fx:id="fromDateFilter" 
                                style="-fx-background-color: #0a0a0a; -fx-text-fill: #ffffff; -fx-prompt-text-fill: #6b7280; -fx-border-color: #1f1f1f; -fx-border-radius: 6; -fx-background-radius: 6;"
                                prefWidth="130"/>
                    
                    <Label text="To:" styleClass="stat-label"/>
                    <DatePicker fx:id="toDateFilter" 
                                style="-fx-background-color: #0a0a0a; -fx-text-fill: #ffffff; -fx-prompt-text-fill: #6b7280; -fx-border-color: #1f1f1f; -fx-border-radius: 6; -fx-background-radius: 6;"
                                prefWidth="130"/>
                    
                    <Button fx:id="refreshButton" text="Refresh" onAction="#handleRefresh" 
                            styleClass="header-button"/>
                </HBox>
            </VBox>
            
            <!-- Main Content -->
            <HBox spacing="24" VBox.vgrow="ALWAYS">
                <!-- Fines Table -->
                <VBox spacing="16" HBox.hgrow="ALWAYS">
                    <Label styleClass="section-title" text="Pending Fines"/>
                    <TableView fx:id="finesTable" styleClass="data-table" VBox.vgrow="ALWAYS">
                        <columns>
                            <TableColumn fx:id="idColumn" prefWidth="60" text="ID" styleClass="table-column"/>
                            <TableColumn fx:id="bookColumn" prefWidth="220" text="Book" styleClass="table-column"/>
                            <TableColumn fx:id="memberColumn" prefWidth="180" text="Member" styleClass="table-column"/>
                            <TableColumn fx:id="dueDateColumn" prefWidth="110" text="Due Date" styleClass="table-column"/>
                            <TableColumn fx:id="daysOverdueColumn" prefWidth="120" text="Days Overdue" styleClass="table-column"/>
                            <TableColumn fx:id="fineAmountColumn" prefWidth="90" text="Amount" styleClass="table-column"/>
                            <TableColumn fx:id="statusColumn" prefWidth="120" text="Status" styleClass="table-column"/>
                        </columns>
                    </TableView>
                    
                    <!-- Action Buttons -->
                    <HBox spacing="10">
                        <Button fx:id="payButton" text="Pay Fine" onAction="#handlePay" 
                                styleClass="header-button-success" HBox.hgrow="ALWAYS"/>
                        <Button fx:id="waiveButton" text="Waive Fine" onAction="#handleWaive" 
                                styleClass="header-button-info" HBox.hgrow="ALWAYS"/>
                        <Button fx:id="viewDetailsButton" text="View Details" onAction="#handleViewDetails" 
                                styleClass="header-button" HBox.hgrow="ALWAYS"/>
                        <Button fx:id="generateReportButton" text="Generate Report" onAction="#handleGenerateReport" 
                                styleClass="header-button" HBox.hgrow="ALWAYS"/>
                    </HBox>
                </VBox>
                
                <!-- Recent Transactions -->
                <VBox spacing="16" style="-fx-min-width: 320; -fx-pref-width: 320;">
                    <Label styleClass="section-title" text="Recent Transactions"/>
                    <VBox styleClass="chart-section" spacing="16" VBox.vgrow="ALWAYS">
                        <TableView fx:id="transactionsTable" styleClass="data-table" VBox.vgrow="ALWAYS">
                            <columns>
                                <TableColumn fx:id="receiptColumn" prefWidth="140" text="Receipt #" styleClass="table-column"/>
                                <TableColumn fx:id="dateColumn" prefWidth="160" text="Date" styleClass="table-column"/>
                                <TableColumn fx:id="amountColumn" prefWidth="90" text="Amount" styleClass="table-column"/>
                                <TableColumn fx:id="methodColumn" prefWidth="120" text="Method" styleClass="table-column"/>
                                <TableColumn fx:id="statusColumn2" prefWidth="120" text="Status" styleClass="table-column"/>
                            </columns>
                            <columnResizePolicy>
                                <TableView fx:constant="CONSTRAINED_RESIZE_POLICY" />
                            </columnResizePolicy>
                        </TableView>
                        
                        <!-- Quick Actions -->
                        <!-- <VBox spacing="8">
                            <Label styleClass="stat-label" text="Quick Actions"/>
                            <HBox spacing="10">
                                <Button text="Export CSV" 
                                        styleClass="header-button"
                                        onAction="#handleExportCSV" HBox.hgrow="ALWAYS"/>
                                <Button text="Print Report" 
                                        styleClass="header-button"
                                        onAction="#handlePrintReport" HBox.hgrow="ALWAYS"/>
                            </HBox>
                        </VBox> -->
                    </VBox>
                </VBox>
            </HBox>
            
            <!-- Close Button -->
            <HBox alignment="CENTER_RIGHT">
                <Button fx:id="closeButton" text="Close" onAction="#handleClose" 
                        styleClass="header-button"/>
            </HBox>
            
            <!-- Status Bar -->
            <Label fx:id="statusLabel" styleClass="stat-change-positive"/>
        </VBox>
    </ScrollPane>
</VBox>