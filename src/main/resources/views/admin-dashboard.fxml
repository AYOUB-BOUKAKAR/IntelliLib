<?xml version="1.0" encoding="UTF-8"?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.geometry.Insets?>
<?import javafx.scene.control.cell.PropertyValueFactory?>

<BorderPane xmlns="http://javafx.com/javafx/21" 
            xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="com.intellilib.controllers.AdminDashboardController"
            stylesheets="@/css/style.css"
            styleClass="root">

    <!-- Sidebar -->
    <left>
        <VBox styleClass="sidebar" spacing="0">
            <!-- Sidebar Header -->
            <VBox styleClass="sidebar-header">
                <Label text="IntelliLib" styleClass="sidebar-title" />
                <Label text="Admin Dashboard" styleClass="sidebar-subtitle" />
            </VBox>
            
            <!-- Sidebar Navigation -->
            <VBox styleClass="sidebar-nav" spacing="4" VBox.vgrow="ALWAYS">
                <!-- <Button text="Dashboard" styleClass="nav-button, nav-button-active" onAction="#showDashboard" /> -->
                <Button text="Books" styleClass="nav-button" onAction="#manageBooks" />
                <Button text="Members" styleClass="nav-button" onAction="#manageMembers" />
                <Button text="Users" styleClass="nav-button" onAction="#manageUsers" />
                <Button text="Borrowings" styleClass="nav-button" onAction="#manageBorrowings" />
                <Button text="Fines" styleClass="nav-button" onAction="#manageFines" />
                <Button text="Categories" styleClass="nav-button" onAction="#manageCategories" />
                <Button text="Reports" styleClass="nav-button" onAction="#viewReports" />
                <Button text="Settings" styleClass="nav-button" onAction="#systemSettings" />
                
                <!-- Spacer -->
                <Region VBox.vgrow="ALWAYS" />
                
                <Separator styleClass="sidebar-separator" />
                <Button text="Backup Database" styleClass="nav-button" onAction="#backupDatabase" />
                <Button text="Logout" styleClass="nav-button, nav-button-logout" onAction="#logout" />
            </VBox>
        </VBox>
    </left>

    <!-- Main Content -->
    <center>
        <VBox styleClass="main-content">
            <!-- Header -->
            <HBox styleClass="site-header" alignment="CENTER_LEFT">
                <VBox HBox.hgrow="ALWAYS">
                    <Label text="Dashboard" styleClass="page-title" />
                    <Label fx:id="welcomeLabel" styleClass="page-subtitle" />
                </VBox>
                <Button text="User Profile" styleClass="header-button" />
            </HBox>
            
            <!-- Scrollable Content -->
            <ScrollPane styleClass="content-scroll" fitToWidth="true" VBox.vgrow="ALWAYS">
                <VBox styleClass="content-container" spacing="24">
                    <!-- Statistics Cards -->
                    <GridPane styleClass="stats-grid" hgap="16" vgap="16">
                        <!-- Card 1 -->
                        <VBox styleClass="stat-card" GridPane.rowIndex="0" GridPane.columnIndex="0">
                            <Label text="Total Books" styleClass="stat-label" />
                            <Label fx:id="totalBooksLabel" text="0" styleClass="stat-value" />
                            <Label text="+12% from last month" styleClass="stat-change" />
                        </VBox>
                        
                        <!-- Card 2 -->
                        <VBox styleClass="stat-card" GridPane.rowIndex="0" GridPane.columnIndex="1">
                            <Label text="Active Members" styleClass="stat-label" />
                            <Label fx:id="activeMembersLabel" text="0" styleClass="stat-value" />
                            <Label text="+8% from last month" styleClass="stat-change" />
                        </VBox>
                        
                        <!-- Card 3 -->
                        <VBox styleClass="stat-card" GridPane.rowIndex="0" GridPane.columnIndex="2">
                            <Label text="Active Borrowings" styleClass="stat-label" />
                            <Label fx:id="activeBorrowingsLabel" text="0" styleClass="stat-value" />
                            <Label text="+23% from last month" styleClass="stat-change" />
                        </VBox>
                        
                        <!-- Card 4 -->
                        <VBox styleClass="stat-card" GridPane.rowIndex="0" GridPane.columnIndex="3">
                            <Label text="Overdue Books" styleClass="stat-label" />
                            <Label fx:id="overdueBooksLabel" text="0" styleClass="stat-value" />
                            <Label text="-5% from last month" styleClass="stat-change, stat-change-positive" />
                        </VBox>
                        
                        <!-- Card 5: Total Fines Card (ADDED) -->
                        <VBox styleClass="stat-card" GridPane.rowIndex="1" GridPane.columnIndex="0">
                            <Label text="Total Fines" styleClass="stat-label" />
                            <Label fx:id="totalFinesLabel" text="0.00 â‚¬" styleClass="stat-value" />
                            <Label text="Current outstanding fines" styleClass="stat-change" />
                        </VBox>
                    </GridPane>
                    
                    <!-- Chart Section -->
                    <VBox styleClass="chart-section">
                        <Label text="Activity Overview" styleClass="section-title" />
                        <StackPane styleClass="chart-container" minHeight="300">
                            <Label text="Chart Area - Interactive Chart Here" styleClass="chart-placeholder" />
                        </StackPane>
                    </VBox>
                    
                    <!-- Data Tables -->
                    <VBox styleClass="table-section" spacing="24">
                        <!-- Recent Activity Table -->
                        <VBox spacing="12">
                            <Label text="Recent Activity" styleClass="section-title" />
                            <TableView fx:id="recentActivityTable" styleClass="data-table">
                                <columns>
                                    <TableColumn fx:id="userColumn" text="User" prefWidth="200" styleClass="table-column">
                                        <cellValueFactory>
                                            <PropertyValueFactory property="user.username" />
                                        </cellValueFactory>
                                    </TableColumn>
                                    <TableColumn fx:id="actionColumn" text="Action" prefWidth="300" styleClass="table-column">
                                        <cellValueFactory>
                                            <PropertyValueFactory property="action" />
                                        </cellValueFactory>
                                    </TableColumn>
                                    <TableColumn fx:id="timestampColumn" text="Timestamp" prefWidth="200" styleClass="table-column">
                                        <cellValueFactory>
                                            <PropertyValueFactory property="timestamp" />
                                        </cellValueFactory>
                                    </TableColumn>
                                    <TableColumn text="Status" prefWidth="150" styleClass="table-column">
                                        <cellValueFactory>
                                            <PropertyValueFactory property="status" />
                                        </cellValueFactory>
                                    </TableColumn>
                                </columns>
                            </TableView>
                        </VBox>
                        
                        <!-- Recent Users Table -->
                        <VBox spacing="12">
                            <Label text="Recent Users" styleClass="section-title" />
                            <TableView fx:id="recentUsersTable" styleClass="data-table">
                                <columns>
                                    <TableColumn fx:id="usernameColumn" text="Username" prefWidth="200" styleClass="table-column">
                                        <cellValueFactory>
                                            <PropertyValueFactory property="username" />
                                        </cellValueFactory>
                                    </TableColumn>
                                    <TableColumn fx:id="emailColumn" text="Email" prefWidth="250" styleClass="table-column">
                                        <cellValueFactory>
                                            <PropertyValueFactory property="email" />
                                        </cellValueFactory>
                                    </TableColumn>
                                    <TableColumn fx:id="roleColumn" text="Role" prefWidth="150" styleClass="table-column">
                                        <cellValueFactory>
                                            <PropertyValueFactory property="role" />
                                        </cellValueFactory>
                                    </TableColumn>
                                    <TableColumn fx:id="joinedDateColumn" text="Joined Date" prefWidth="200" styleClass="table-column">
                                        <cellValueFactory>
                                            <PropertyValueFactory property="createdAt" />
                                        </cellValueFactory>
                                    </TableColumn>
                                </columns>
                            </TableView>
                        </VBox>
                    </VBox>
                </VBox>
            </ScrollPane>
        </VBox>
    </center>

</BorderPane>